<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of LAPLACE_EIG</title>
  <meta name="keywords" content="LAPLACE_EIG">
  <meta name="description" content="computes the Laplace eigenvalues, eigenfunctions">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">SRC</a> &gt; LAPLACE_EIG.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for SRC&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>LAPLACE_EIG
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>computes the Laplace eigenvalues, eigenfunctions</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [EIG_value,EIG_proj,EIG_func,ctime]= LAPLACE_EIG(Pts_cmpt_reorder,Ele_cmpt_reorder,DIFF,VOL,EigLim,EigLim_min,EigIntervals) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> computes the Laplace eigenvalues, eigenfunctions 
 and the first order moments of the products of the eigenfuntctions
 
 Input:
     1. Pts_cmpt_reorder
     2. Ele_cmpt_reorder
     3. DIFF
     4. VOL
     5. EigLim
     6. EigLim_min
     7. EigIntervals
     
 Output:
     1. EIG_value
     2. EIG_proj
     3. EIG_func
     4. ctime</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [EIG_value,EIG_proj,EIG_func,ctime] </a><span class="keyword">...</span>
0002     = LAPLACE_EIG(Pts_cmpt_reorder,Ele_cmpt_reorder,<span class="keyword">...</span>
0003     DIFF,VOL,EigLim,EigLim_min,EigIntervals)
0004 
0005 <span class="comment">% computes the Laplace eigenvalues, eigenfunctions</span>
0006 <span class="comment">% and the first order moments of the products of the eigenfuntctions</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Input:</span>
0009 <span class="comment">%     1. Pts_cmpt_reorder</span>
0010 <span class="comment">%     2. Ele_cmpt_reorder</span>
0011 <span class="comment">%     3. DIFF</span>
0012 <span class="comment">%     4. VOL</span>
0013 <span class="comment">%     5. EigLim</span>
0014 <span class="comment">%     6. EigLim_min</span>
0015 <span class="comment">%     7. EigIntervals</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Output:</span>
0018 <span class="comment">%     1. EIG_value</span>
0019 <span class="comment">%     2. EIG_proj</span>
0020 <span class="comment">%     3. EIG_func</span>
0021 <span class="comment">%     4. ctime</span>
0022 
0023 <span class="keyword">global</span> FEM_M FEM_K
0024 
0025 ttt=cputime;
0026 
0027 model_orig = createpde();
0028 geometryFromMesh(model_orig,Pts_cmpt_reorder,Ele_cmpt_reorder);
0029 
0030 sigma0 = DIFF;
0031 <span class="comment">% compute the eigenvalues and eigenfunctions and save them</span>
0032 specifyCoefficients(model_orig,<span class="string">'m'</span>,0,<span class="string">'d'</span>,1,<span class="string">'c'</span>,sigma0,<span class="string">'a'</span>, 0,<span class="string">'f'</span>,0);
0033 nface = model_orig.Geometry.NumFaces; <span class="comment">%number of face</span>
0034 <span class="comment">%     normal dot (c grad u) + q*u = g</span>
0035 <span class="keyword">for</span> iface = 1:nface
0036     applyBoundaryCondition(model_orig,<span class="string">'neumann'</span>,<span class="string">'face'</span>,iface,<span class="string">'g'</span>,0,<span class="string">'q'</span>,0,<span class="string">'Vectorized'</span>,<span class="string">'on'</span>); <span class="comment">% 3-D geometry</span>
0037 <span class="keyword">end</span>
0038 
0039 model_FEM_matrices = assembleFEMatrices(model_orig);
0040 <span class="comment">% Define coefficients of PDE (diffusion equation)</span>
0041 FEM_M = model_FEM_matrices.M;
0042 FEM_K = model_FEM_matrices.K;
0043 
0044 P = model_orig.Mesh.Nodes;
0045 
0046 CenterMass_cmpts = zeros(3,1);
0047 CenterMass_cmpts(1,1) = sum(FEM_M*((P(1,:)')))/VOL;
0048 CenterMass_cmpts(2,1) = sum(FEM_M*((P(2,:)')))/VOL;
0049 CenterMass_cmpts(3,1) = sum(FEM_M*((P(3,:)')))/VOL;
0050 
0051 <span class="comment">%disp(['center of mass = ']);</span>
0052 <span class="comment">%CenterMass_cmpts{icmpt}</span>
0053 
0054 P(1,:) = P(1,:)-CenterMass_cmpts(1,1);
0055 P(2,:) = P(2,:)-CenterMass_cmpts(2,1);
0056 P(3,:) = P(3,:)-CenterMass_cmpts(3,1);
0057 
0058 
0059 model_shift = createpde();
0060 geometryFromMesh(model_shift,P,Ele_cmpt_reorder);
0061 sigma0 = DIFF;
0062 <span class="comment">% compute the eigenvalues and eigenfunctions and save them</span>
0063 specifyCoefficients(model_shift,<span class="string">'m'</span>,0,<span class="string">'d'</span>,1,<span class="string">'c'</span>,sigma0,<span class="string">'a'</span>, 0,<span class="string">'f'</span>,0);
0064 nface = model_shift.Geometry.NumFaces; <span class="comment">%number of face</span>
0065 <span class="comment">%     normal dot (c grad u) + q*u = g</span>
0066 <span class="keyword">for</span> iface = 1:nface
0067     applyBoundaryCondition(model_shift,<span class="string">'neumann'</span>,<span class="string">'face'</span>,iface,<span class="string">'g'</span>,0,<span class="string">'q'</span>,0,<span class="string">'Vectorized'</span>,<span class="string">'on'</span>); <span class="comment">% 3-D geometry</span>
0068 <span class="keyword">end</span>
0069 D = 1;
0070 C = sigma0;
0071 A = 0;
0072 
0073 nint = EigIntervals;
0074 
0075 
0076 V = [];
0077 eigvals = [];
0078 evec = linspace(0,EigLim,nint+1);
0079 evec(1) = EigLim_min;
0080 <span class="keyword">for</span> iint = 2:nint+1
0081     e0 = evec(iint-1)+1e-16;
0082     ef = evec(iint);
0083     disp([e0,ef]/DIFF);
0084     EigenResults = solvepdeeig(model_shift,[e0,ef])
0085     V = [V,EigenResults.Eigenvectors];
0086     eigvals = [eigvals; EigenResults.Eigenvalues];
0087 <span class="keyword">end</span>
0088 
0089 
0090 neig = length(eigvals);
0091 
0092 eigvals = eigvals(1:neig);
0093 
0094 V = V(:,1:neig);
0095 
0096 neig = length(eigvals);
0097 
0098 <span class="comment">% normalize the eigenfunctions and calculate</span>
0099 Ueig_N = V;
0100 <span class="keyword">for</span> ieig = 1:neig
0101     normUeig(ieig) = sqrt(Ueig_N(:,ieig)'*FEM_M*Ueig_N(:,ieig));
0102     Ueig_N(:,ieig) = Ueig_N(:,ieig)/normUeig(ieig);
0103 <span class="keyword">end</span>
0104 
0105 EIG_proj = zeros(3,neig,neig);
0106 <span class="keyword">for</span> ieig = 1:neig
0107     <span class="keyword">for</span> jeig = 1:neig
0108         EIG_proj(1,ieig,jeig) = sum(FEM_M*(Ueig_N(:,jeig).*Ueig_N(:,ieig).*(P(1,:)')));
0109         EIG_proj(2,ieig,jeig) = sum(FEM_M*(Ueig_N(:,jeig).*Ueig_N(:,ieig).*(P(2,:)')));
0110         EIG_proj(3,ieig,jeig) = sum(FEM_M*(Ueig_N(:,jeig).*Ueig_N(:,ieig).*(P(3,:)')));
0111     <span class="keyword">end</span>
0112 <span class="keyword">end</span>
0113 
0114 
0115 <span class="comment">% normalized eigenfunctions</span>
0116 EIG_func = Ueig_N;
0117 <span class="comment">% eigenvalues</span>
0118 EIG_value = eigvals;
0119 
0120 ctime = cputime-ttt;
0121 
0122</pre></div>
<hr><address>Generated on Sun 10-Nov-2019 21:21:13 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>