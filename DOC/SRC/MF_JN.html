<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of MF_JN</title>
  <meta name="keywords" content="MF_JN">
  <meta name="description" content="compute the quantity J(lambda_n,f)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">SRC</a> &gt; MF_JN.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for SRC&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>MF_JN
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>compute the quantity J(lambda_n,f)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [MF_JN_cmpts] = MF_JN(EIG_value_cmpts,DIFF_cmpts,experiment) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> compute the quantity J(lambda_n,f)
 
 Input:
     1. EIG_value_cmpts
     2. DIFF_cmpts
     3. experiment is a structure with 10 elements:
         ngdir_total 
         gdir        
         sdeltavec   
         bdeltavec   
         seqvec       
         npervec     
         rtol        
         atol        
         qvalues     
         bvalues  
 
 Output:
     MF_JN_cmpts</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [MF_JN_cmpts] = MF_JN(EIG_value_cmpts,DIFF_cmpts,experiment)</a>
0002 
0003 <span class="comment">% compute the quantity J(lambda_n,f)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Input:</span>
0006 <span class="comment">%     1. EIG_value_cmpts</span>
0007 <span class="comment">%     2. DIFF_cmpts</span>
0008 <span class="comment">%     3. experiment is a structure with 10 elements:</span>
0009 <span class="comment">%         ngdir_total</span>
0010 <span class="comment">%         gdir</span>
0011 <span class="comment">%         sdeltavec</span>
0012 <span class="comment">%         bdeltavec</span>
0013 <span class="comment">%         seqvec</span>
0014 <span class="comment">%         npervec</span>
0015 <span class="comment">%         rtol</span>
0016 <span class="comment">%         atol</span>
0017 <span class="comment">%         qvalues</span>
0018 <span class="comment">%         bvalues</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% Output:</span>
0021 <span class="comment">%     MF_JN_cmpts</span>
0022 
0023 
0024 Ncmpt = length(DIFF_cmpts);
0025 
0026 <span class="keyword">global</span> BDELTA SDELTA SEQ OGSEPER
0027 
0028 gdir = experiment.gdir;
0029 sdeltavec = experiment.sdeltavec;
0030 bdeltavec = experiment.bdeltavec;
0031 seqvec = experiment.seqvec;
0032 npervec = experiment.npervec;
0033 
0034 <span class="keyword">for</span> icmpt = 1:Ncmpt
0035     neig = length(EIG_value_cmpts{icmpt});
0036     nexperi = length(sdeltavec);
0037     <span class="keyword">for</span> iexperi = 1:nexperi
0038         SDELTA = sdeltavec(iexperi);
0039         BDELTA = bdeltavec(iexperi);
0040         TE = SDELTA+BDELTA;
0041         SEQ = seqvec(iexperi);<span class="comment">% for choosing case PGSE, OGSEcos or OGSEsin</span>
0042         omega = 2*pi*npervec(iexperi)/SDELTA;
0043         OGSEPER = 1./omega*2*pi;<span class="comment">%% set up number for OGSE</span>
0044         bvaluenoq(iexperi) = seqbvaluenoq;
0045         dtime = 10;
0046         TLIST = linspace(0,SDELTA+BDELTA,round((SDELTA+BDELTA)/dtime)+1);
0047         <span class="keyword">for</span> ieig = 1:neig
0048             const = EIG_value_cmpts{icmpt}(ieig);
0049             <span class="keyword">if</span> (seqvec(iexperi) == 1)
0050                 <span class="keyword">if</span> (abs(const)&lt;1e-16)
0051                     dtmp = 0;
0052                 <span class="keyword">else</span>
0053                     ff = -1/(const^2)*(exp(-const*(BDELTA+SDELTA))+<span class="keyword">...</span>
0054                         exp(-const*(BDELTA-SDELTA))-<span class="keyword">...</span>
0055                         2*(const*SDELTA+exp(-const*SDELTA)+exp(-const*BDELTA)-1));
0056                     dtmp = 1/bvaluenoq(iexperi)*ff;
0057                 <span class="keyword">end</span>
0058             <span class="keyword">else</span>
0059                 fint = zeros(1,length(TLIST));
0060                 <span class="keyword">if</span> (const*TLIST(end)&lt;=1e-3)
0061                     <span class="keyword">for</span> idt=1:length(TLIST)
0062                         fint(idt) = fexp_taylor(const,TLIST(idt));
0063                     <span class="keyword">end</span>
0064                 <span class="keyword">else</span>
0065                     <span class="keyword">for</span> idt=1:length(TLIST)
0066                         fint(idt) = fexp(const,TLIST(idt),TE);
0067                     <span class="keyword">end</span>
0068                 <span class="keyword">end</span>
0069                 functime_eig{iexperi}(ieig,:) = 1/bvaluenoq(iexperi)*(fint);
0070                 fint = functime_eig{iexperi}(ieig,:);
0071                 dtmp = dtime*(sum(fint(2:end-1))+fint(1)/2+fint(end)/2);
0072             <span class="keyword">end</span>
0073             MF_JN_cmpts{icmpt}(iexperi,ieig) = dtmp/DIFF_cmpts(icmpt);
0074         <span class="keyword">end</span>
0075     <span class="keyword">end</span>
0076     
0077 <span class="keyword">end</span>
0078</pre></div>
<hr><address>Generated on Sun 10-Nov-2019 21:21:13 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>